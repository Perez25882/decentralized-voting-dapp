{"ast":null,"code":"\"use client\";\n\nvar _jsxFileName = \"C:\\\\Users\\\\DELL\\\\Desktop\\\\decentralized-voting-dapp\\\\src\\\\context\\\\VotingContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { createContext, useContext, useReducer, useEffect } from \"react\";\nimport { ethers } from \"ethers\";\nimport toast from \"react-hot-toast\";\nimport VotingSystemABI from \"../contracts/VotingSystem.json\";\n\n// Import deployment info with error handling\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nlet deploymentInfo;\ntry {\n  deploymentInfo = require(\"../contracts/deployment.json\");\n} catch (error) {\n  console.error(\"Deployment file not found. Please deploy the contract first.\");\n  deploymentInfo = {\n    contractAddress: \"0x0000000000000000000000000000000000000000\",\n    electoralCommission: \"0x64E01a30a963206345bE12DEcEcDA08d78c9a2a5\"\n  };\n}\nconst VotingContext = /*#__PURE__*/createContext();\nconst initialState = {\n  account: null,\n  contract: null,\n  provider: null,\n  signer: null,\n  isConnected: false,\n  isLoading: false,\n  voter: null,\n  currentElection: null,\n  candidates: [],\n  allElections: [],\n  isAdmin: false,\n  error: null\n};\nfunction votingReducer(state, action) {\n  switch (action.type) {\n    case \"SET_LOADING\":\n      return {\n        ...state,\n        isLoading: action.payload\n      };\n    case \"SET_ACCOUNT\":\n      return {\n        ...state,\n        account: action.payload\n      };\n    case \"SET_CONNECTION\":\n      return {\n        ...state,\n        provider: action.payload.provider,\n        signer: action.payload.signer,\n        contract: action.payload.contract,\n        isConnected: true\n      };\n    case \"SET_VOTER\":\n      return {\n        ...state,\n        voter: action.payload\n      };\n    case \"SET_CURRENT_ELECTION\":\n      return {\n        ...state,\n        currentElection: action.payload\n      };\n    case \"SET_ALL_ELECTIONS\":\n      return {\n        ...state,\n        allElections: action.payload\n      };\n    case \"SET_CANDIDATES\":\n      return {\n        ...state,\n        candidates: action.payload\n      };\n    case \"SET_IS_ADMIN\":\n      return {\n        ...state,\n        isAdmin: action.payload\n      };\n    case \"SET_ERROR\":\n      return {\n        ...state,\n        error: action.payload\n      };\n    case \"DISCONNECT\":\n      return {\n        ...initialState\n      };\n    default:\n      return state;\n  }\n}\nexport function VotingProvider({\n  children\n}) {\n  _s();\n  const [state, dispatch] = useReducer(votingReducer, initialState);\n\n  // FIXED: Robust voter ID validation function\n  const validateVoterId = async voterId => {\n    if (!voterId || !state.contract) {\n      return {\n        isValid: false,\n        isAvailable: false,\n        message: \"Invalid input\"\n      };\n    }\n    try {\n      // Method 1: Try the new validation function\n      try {\n        const result = await state.contract.checkVoterIdAvailability(voterId);\n        return {\n          isValid: result.isValid,\n          isAvailable: result.isAvailable,\n          message: result.message\n        };\n      } catch (newFunctionError) {\n        console.log(\"New function not available, using fallback validation\");\n\n        // Method 2: Fallback validation using individual contract calls\n        try {\n          // Check if voter ID is in valid list\n          const isValidId = await state.contract.validVoterIds(voterId);\n          if (!isValidId) {\n            return {\n              isValid: false,\n              isAvailable: false,\n              message: \"Voter ID not found in Electoral Commission database\"\n            };\n          }\n\n          // Check if voter ID is already used\n          const isUsed = await state.contract.usedVoterIds(voterId);\n          if (isUsed) {\n            return {\n              isValid: true,\n              isAvailable: false,\n              message: \"Voter ID already registered\"\n            };\n          }\n\n          // Check if voter ID is linked to an address\n          const linkedAddress = await state.contract.voterIdToAddress(voterId);\n          if (linkedAddress !== \"0x0000000000000000000000000000000000000000\") {\n            return {\n              isValid: true,\n              isAvailable: false,\n              message: \"Voter ID already linked to another wallet\"\n            };\n          }\n          return {\n            isValid: true,\n            isAvailable: true,\n            message: \"Voter ID is valid and available\"\n          };\n        } catch (fallbackError) {\n          console.error(\"Fallback validation failed:\", fallbackError);\n\n          // Method 3: Final fallback - basic validation\n          const validIds = [\"VOTER001\", \"VOTER002\", \"VOTER003\", \"VOTER004\", \"VOTER005\", \"VOTER006\", \"VOTER007\", \"VOTER008\", \"VOTER009\", \"VOTER010\", \"VOTER011\", \"VOTER012\", \"VOTER013\", \"VOTER014\", \"VOTER015\", \"VOTER016\", \"VOTER017\", \"VOTER018\", \"VOTER019\", \"VOTER020\"];\n          const isValid = validIds.includes(voterId);\n          return {\n            isValid: isValid,\n            isAvailable: isValid,\n            message: isValid ? \"Voter ID is valid and available\" : \"Invalid Voter ID format\"\n          };\n        }\n      }\n    } catch (error) {\n      console.error(\"All validation methods failed:\", error);\n      return {\n        isValid: false,\n        isAvailable: false,\n        message: \"Unable to validate voter ID at this time\"\n      };\n    }\n  };\n\n  // Initialize Web3 connection\n  const connectWallet = async () => {\n    try {\n      dispatch({\n        type: \"SET_LOADING\",\n        payload: true\n      });\n      if (!window.ethereum) {\n        throw new Error(\"MetaMask is not installed\");\n      }\n\n      // Check if contract is deployed\n      if (deploymentInfo.contractAddress === \"0x0000000000000000000000000000000000000000\") {\n        throw new Error(\"Contract not deployed. Please run 'npm run hardhat:deploy' first.\");\n      }\n      const accounts = await window.ethereum.request({\n        method: \"eth_requestAccounts\"\n      });\n\n      // Check network\n      const chainId = await window.ethereum.request({\n        method: \"eth_chainId\"\n      });\n      if (chainId !== \"0x539\") {\n        // 1337 in hex\n        try {\n          await window.ethereum.request({\n            method: \"wallet_switchEthereumChain\",\n            params: [{\n              chainId: \"0x539\"\n            }]\n          });\n        } catch (switchError) {\n          // Network doesn't exist, add it\n          await window.ethereum.request({\n            method: \"wallet_addEthereumChain\",\n            params: [{\n              chainId: \"0x539\",\n              chainName: \"Hardhat Local\",\n              nativeCurrency: {\n                name: \"ETH\",\n                symbol: \"ETH\",\n                decimals: 18\n              },\n              rpcUrls: [\"http://127.0.0.1:8545\"]\n            }]\n          });\n        }\n      }\n      const provider = new ethers.BrowserProvider(window.ethereum);\n      const signer = await provider.getSigner();\n\n      // Test connection to contract\n      const contract = new ethers.Contract(deploymentInfo.contractAddress, VotingSystemABI.abi, signer);\n\n      // Test contract call\n      try {\n        await contract.electoralCommission();\n      } catch (error) {\n        throw new Error(\"Cannot connect to contract. Make sure Hardhat node is running on localhost:8545\");\n      }\n      dispatch({\n        type: \"SET_CONNECTION\",\n        payload: {\n          provider,\n          signer,\n          contract\n        }\n      });\n      dispatch({\n        type: \"SET_ACCOUNT\",\n        payload: accounts[0]\n      });\n\n      // Check if user is admin\n      const electoralCommission = await contract.electoralCommission();\n      const isAdmin = accounts[0].toLowerCase() === electoralCommission.toLowerCase();\n      dispatch({\n        type: \"SET_IS_ADMIN\",\n        payload: isAdmin\n      });\n\n      // Load voter data if not admin\n      if (!isAdmin) {\n        await loadVoterData(contract, accounts[0]);\n      }\n\n      // Load current election and all elections\n      await loadCurrentElection(contract);\n      await loadAllElections(contract);\n      toast.success(\"Wallet connected successfully!\");\n    } catch (error) {\n      console.error(\"Connection error:\", error);\n      dispatch({\n        type: \"SET_ERROR\",\n        payload: error.message\n      });\n      toast.error(error.message);\n    } finally {\n      dispatch({\n        type: \"SET_LOADING\",\n        payload: false\n      });\n    }\n  };\n\n  // Load voter data\n  const loadVoterData = async (contract, account) => {\n    try {\n      const voter = await contract.getVoter(account);\n      if (voter.walletAddress !== \"0x0000000000000000000000000000000000000000\") {\n        dispatch({\n          type: \"SET_VOTER\",\n          payload: voter\n        });\n      }\n    } catch (error) {\n      console.error(\"Error loading voter data:\", error);\n    }\n  };\n\n  // Load current election\n  const loadCurrentElection = async contract => {\n    try {\n      const election = await contract.getCurrentElection();\n      console.log(\"Current election loaded:\", election);\n      if (election.id > 0) {\n        dispatch({\n          type: \"SET_CURRENT_ELECTION\",\n          payload: election\n        });\n        await loadCandidates(contract, election.id);\n      } else {\n        dispatch({\n          type: \"SET_CURRENT_ELECTION\",\n          payload: null\n        });\n        dispatch({\n          type: \"SET_CANDIDATES\",\n          payload: []\n        });\n      }\n    } catch (error) {\n      console.error(\"Error loading current election:\", error);\n    }\n  };\n\n  // Load all elections\n  const loadAllElections = async contract => {\n    try {\n      const electionCounter = await contract.electionCounter();\n      const elections = [];\n      for (let i = 1; i <= electionCounter; i++) {\n        try {\n          const election = await contract.getElection(i);\n          if (election.id > 0) {\n            elections.push(election);\n          }\n        } catch (error) {\n          console.error(`Error loading election ${i}:`, error);\n        }\n      }\n      console.log(\"All elections loaded:\", elections);\n      dispatch({\n        type: \"SET_ALL_ELECTIONS\",\n        payload: elections\n      });\n    } catch (error) {\n      console.error(\"Error loading all elections:\", error);\n    }\n  };\n\n  // Load candidates for current election\n  const loadCandidates = async (contract, electionId) => {\n    try {\n      const candidates = await contract.getElectionResults(electionId);\n      dispatch({\n        type: \"SET_CANDIDATES\",\n        payload: candidates\n      });\n    } catch (error) {\n      console.error(\"Error loading candidates:\", error);\n    }\n  };\n\n  // Register voter with improved validation\n  const registerVoter = async voterData => {\n    try {\n      dispatch({\n        type: \"SET_LOADING\",\n        payload: true\n      });\n\n      // Validate voter ID before submitting\n      const validation = await validateVoterId(voterData.voterId);\n      if (!validation.isValid || !validation.isAvailable) {\n        toast.error(validation.message);\n        return false;\n      }\n\n      // Estimate gas first\n      const gasEstimate = await state.contract.requestRegistration.estimateGas(voterData.voterId, voterData.name, voterData.nationalId, voterData.email);\n      const tx = await state.contract.requestRegistration(voterData.voterId, voterData.name, voterData.nationalId, voterData.email, {\n        gasLimit: gasEstimate * 120n / 100n // Add 20% buffer\n      });\n      await tx.wait();\n      toast.success(\"Registration request submitted successfully!\");\n      return true;\n    } catch (error) {\n      console.error(\"Registration error:\", error);\n\n      // Handle specific error messages\n      if (error.message && error.message.includes(\"Voter ID not found in Electoral Commission database\")) {\n        toast.error(\"Voter ID not found in Electoral Commission database\");\n      } else if (error.message && error.message.includes(\"Voter ID already registered\")) {\n        toast.error(\"This Voter ID has already been registered\");\n      } else if (error.message && error.message.includes(\"Voter ID already linked\")) {\n        toast.error(\"This Voter ID is already linked to another wallet\");\n      } else {\n        toast.error(error.reason || \"Registration failed. Please try again.\");\n      }\n      return false;\n    } finally {\n      dispatch({\n        type: \"SET_LOADING\",\n        payload: false\n      });\n    }\n  };\n\n  // Cast vote\n  const castVote = async candidateId => {\n    try {\n      dispatch({\n        type: \"SET_LOADING\",\n        payload: true\n      });\n\n      // Estimate gas first\n      const gasEstimate = await state.contract.vote.estimateGas(candidateId);\n      const tx = await state.contract.vote(candidateId, {\n        gasLimit: gasEstimate * 120n / 100n // Add 20% buffer\n      });\n      await tx.wait();\n\n      // Reload voter data and candidates\n      await loadVoterData(state.contract, state.account);\n      await loadCandidates(state.contract, state.currentElection.id);\n      toast.success(\"Vote cast successfully!\");\n      return true;\n    } catch (error) {\n      console.error(\"Voting error:\", error);\n      toast.error(error.reason || error.message);\n      return false;\n    } finally {\n      dispatch({\n        type: \"SET_LOADING\",\n        payload: false\n      });\n    }\n  };\n\n  // Admin functions\n  const verifyVoter = async requestId => {\n    try {\n      dispatch({\n        type: \"SET_LOADING\",\n        payload: true\n      });\n      const gasEstimate = await state.contract.verifyVoter.estimateGas(requestId);\n      const tx = await state.contract.verifyVoter(requestId, {\n        gasLimit: gasEstimate * 120n / 100n\n      });\n      await tx.wait();\n      toast.success(\"Voter verified successfully!\");\n      return true;\n    } catch (error) {\n      console.error(\"Verification error:\", error);\n      toast.error(error.reason || error.message);\n      return false;\n    } finally {\n      dispatch({\n        type: \"SET_LOADING\",\n        payload: false\n      });\n    }\n  };\n  const addCandidate = async candidateData => {\n    try {\n      dispatch({\n        type: \"SET_LOADING\",\n        payload: true\n      });\n      const gasEstimate = await state.contract.addCandidate.estimateGas(candidateData.name, candidateData.party, candidateData.imageUrl || \"\");\n      const tx = await state.contract.addCandidate(candidateData.name, candidateData.party, candidateData.imageUrl || \"\", {\n        gasLimit: gasEstimate * 120n / 100n\n      });\n      await tx.wait();\n      toast.success(\"Candidate added successfully!\");\n\n      // Reload all elections to update candidate lists\n      await loadAllElections(state.contract);\n      return true;\n    } catch (error) {\n      console.error(\"Add candidate error:\", error);\n      toast.error(error.reason || error.message);\n      return false;\n    } finally {\n      dispatch({\n        type: \"SET_LOADING\",\n        payload: false\n      });\n    }\n  };\n  const createElection = async electionData => {\n    try {\n      dispatch({\n        type: \"SET_LOADING\",\n        payload: true\n      });\n      const gasEstimate = await state.contract.createElection.estimateGas(electionData.title, electionData.description, electionData.candidateIds);\n      const tx = await state.contract.createElection(electionData.title, electionData.description, electionData.candidateIds, {\n        gasLimit: gasEstimate * 120n / 100n\n      });\n      await tx.wait();\n\n      // Reload all elections and current election\n      await loadAllElections(state.contract);\n      await loadCurrentElection(state.contract);\n      toast.success(\"Election created successfully!\");\n      return true;\n    } catch (error) {\n      console.error(\"Create election error:\", error);\n      toast.error(error.reason || error.message);\n      return false;\n    } finally {\n      dispatch({\n        type: \"SET_LOADING\",\n        payload: false\n      });\n    }\n  };\n  const startElection = async (electionId, duration) => {\n    try {\n      dispatch({\n        type: \"SET_LOADING\",\n        payload: true\n      });\n      const gasEstimate = await state.contract.startElection.estimateGas(electionId, duration);\n      const tx = await state.contract.startElection(electionId, duration, {\n        gasLimit: gasEstimate * 120n / 100n\n      });\n      await tx.wait();\n\n      // Reload current election and all elections\n      await loadCurrentElection(state.contract);\n      await loadAllElections(state.contract);\n      toast.success(\"Election started successfully!\");\n      return true;\n    } catch (error) {\n      console.error(\"Start election error:\", error);\n      toast.error(error.reason || error.message);\n      return false;\n    } finally {\n      dispatch({\n        type: \"SET_LOADING\",\n        payload: false\n      });\n    }\n  };\n  const endElection = async electionId => {\n    try {\n      dispatch({\n        type: \"SET_LOADING\",\n        payload: true\n      });\n      const gasEstimate = await state.contract.endElection.estimateGas(electionId);\n      const tx = await state.contract.endElection(electionId, {\n        gasLimit: gasEstimate * 120n / 100n\n      });\n      await tx.wait();\n\n      // Reload current election and all elections\n      await loadCurrentElection(state.contract);\n      await loadAllElections(state.contract);\n      toast.success(\"Election ended successfully!\");\n      return true;\n    } catch (error) {\n      console.error(\"End election error:\", error);\n      toast.error(error.reason || error.message);\n      return false;\n    } finally {\n      dispatch({\n        type: \"SET_LOADING\",\n        payload: false\n      });\n    }\n  };\n\n  // Auto-connect on page load\n  useEffect(() => {\n    const autoConnect = async () => {\n      if (window.ethereum) {\n        try {\n          const accounts = await window.ethereum.request({\n            method: \"eth_accounts\"\n          });\n          if (accounts.length > 0) {\n            await connectWallet();\n          }\n        } catch (error) {\n          console.error(\"Auto-connect error:\", error);\n        }\n      }\n    };\n    autoConnect();\n\n    // Listen for account changes\n    if (window.ethereum) {\n      window.ethereum.on(\"accountsChanged\", accounts => {\n        if (accounts.length === 0) {\n          dispatch({\n            type: \"DISCONNECT\"\n          });\n        } else {\n          connectWallet();\n        }\n      });\n      window.ethereum.on(\"chainChanged\", () => {\n        window.location.reload();\n      });\n    }\n    return () => {\n      if (window.ethereum) {\n        window.ethereum.removeAllListeners(\"accountsChanged\");\n        window.ethereum.removeAllListeners(\"chainChanged\");\n      }\n    };\n  }, []);\n  const value = {\n    ...state,\n    connectWallet,\n    registerVoter,\n    castVote,\n    verifyVoter,\n    addCandidate,\n    createElection,\n    startElection,\n    endElection,\n    validateVoterId,\n    // ADDED: Expose validation function\n    loadCurrentElection: () => loadCurrentElection(state.contract),\n    loadAllElections: () => loadAllElections(state.contract),\n    loadCandidates: electionId => loadCandidates(state.contract, electionId)\n  };\n  return /*#__PURE__*/_jsxDEV(VotingContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 610,\n    columnNumber: 10\n  }, this);\n}\n_s(VotingProvider, \"bgCdjuTOmPdSBRwTap80EFd9Y3U=\");\n_c = VotingProvider;\nexport function useVoting() {\n  _s2();\n  const context = useContext(VotingContext);\n  if (!context) {\n    throw new Error(\"useVoting must be used within a VotingProvider\");\n  }\n  return context;\n}\n_s2(useVoting, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nvar _c;\n$RefreshReg$(_c, \"VotingProvider\");","map":{"version":3,"names":["_jsxFileName","_s","$RefreshSig$","_s2","createContext","useContext","useReducer","useEffect","ethers","toast","VotingSystemABI","jsxDEV","_jsxDEV","deploymentInfo","require","error","console","contractAddress","electoralCommission","VotingContext","initialState","account","contract","provider","signer","isConnected","isLoading","voter","currentElection","candidates","allElections","isAdmin","votingReducer","state","action","type","payload","VotingProvider","children","dispatch","validateVoterId","voterId","isValid","isAvailable","message","result","checkVoterIdAvailability","newFunctionError","log","isValidId","validVoterIds","isUsed","usedVoterIds","linkedAddress","voterIdToAddress","fallbackError","validIds","includes","connectWallet","window","ethereum","Error","accounts","request","method","chainId","params","switchError","chainName","nativeCurrency","name","symbol","decimals","rpcUrls","BrowserProvider","getSigner","Contract","abi","toLowerCase","loadVoterData","loadCurrentElection","loadAllElections","success","getVoter","walletAddress","election","getCurrentElection","id","loadCandidates","electionCounter","elections","i","getElection","push","electionId","getElectionResults","registerVoter","voterData","validation","gasEstimate","requestRegistration","estimateGas","nationalId","email","tx","gasLimit","wait","reason","castVote","candidateId","vote","verifyVoter","requestId","addCandidate","candidateData","party","imageUrl","createElection","electionData","title","description","candidateIds","startElection","duration","endElection","autoConnect","length","on","location","reload","removeAllListeners","value","Provider","fileName","lineNumber","columnNumber","_c","useVoting","context","$RefreshReg$"],"sources":["C:/Users/DELL/Desktop/decentralized-voting-dapp/src/context/VotingContext.js"],"sourcesContent":["\"use client\"\n\nimport { createContext, useContext, useReducer, useEffect } from \"react\"\nimport { ethers } from \"ethers\"\nimport toast from \"react-hot-toast\"\nimport VotingSystemABI from \"../contracts/VotingSystem.json\"\n\n// Import deployment info with error handling\nlet deploymentInfo\ntry {\n  deploymentInfo = require(\"../contracts/deployment.json\")\n} catch (error) {\n  console.error(\"Deployment file not found. Please deploy the contract first.\")\n  deploymentInfo = {\n    contractAddress: \"0x0000000000000000000000000000000000000000\",\n    electoralCommission: \"0x64E01a30a963206345bE12DEcEcDA08d78c9a2a5\",\n  }\n}\n\nconst VotingContext = createContext()\n\nconst initialState = {\n  account: null,\n  contract: null,\n  provider: null,\n  signer: null,\n  isConnected: false,\n  isLoading: false,\n  voter: null,\n  currentElection: null,\n  candidates: [],\n  allElections: [],\n  isAdmin: false,\n  error: null,\n}\n\nfunction votingReducer(state, action) {\n  switch (action.type) {\n    case \"SET_LOADING\":\n      return { ...state, isLoading: action.payload }\n    case \"SET_ACCOUNT\":\n      return { ...state, account: action.payload }\n    case \"SET_CONNECTION\":\n      return {\n        ...state,\n        provider: action.payload.provider,\n        signer: action.payload.signer,\n        contract: action.payload.contract,\n        isConnected: true,\n      }\n    case \"SET_VOTER\":\n      return { ...state, voter: action.payload }\n    case \"SET_CURRENT_ELECTION\":\n      return { ...state, currentElection: action.payload }\n    case \"SET_ALL_ELECTIONS\":\n      return { ...state, allElections: action.payload }\n    case \"SET_CANDIDATES\":\n      return { ...state, candidates: action.payload }\n    case \"SET_IS_ADMIN\":\n      return { ...state, isAdmin: action.payload }\n    case \"SET_ERROR\":\n      return { ...state, error: action.payload }\n    case \"DISCONNECT\":\n      return { ...initialState }\n    default:\n      return state\n  }\n}\n\nexport function VotingProvider({ children }) {\n  const [state, dispatch] = useReducer(votingReducer, initialState)\n\n  // FIXED: Robust voter ID validation function\n  const validateVoterId = async (voterId) => {\n    if (!voterId || !state.contract) {\n      return { isValid: false, isAvailable: false, message: \"Invalid input\" }\n    }\n\n    try {\n      // Method 1: Try the new validation function\n      try {\n        const result = await state.contract.checkVoterIdAvailability(voterId)\n        return {\n          isValid: result.isValid,\n          isAvailable: result.isAvailable,\n          message: result.message,\n        }\n      } catch (newFunctionError) {\n        console.log(\"New function not available, using fallback validation\")\n\n        // Method 2: Fallback validation using individual contract calls\n        try {\n          // Check if voter ID is in valid list\n          const isValidId = await state.contract.validVoterIds(voterId)\n          if (!isValidId) {\n            return {\n              isValid: false,\n              isAvailable: false,\n              message: \"Voter ID not found in Electoral Commission database\",\n            }\n          }\n\n          // Check if voter ID is already used\n          const isUsed = await state.contract.usedVoterIds(voterId)\n          if (isUsed) {\n            return {\n              isValid: true,\n              isAvailable: false,\n              message: \"Voter ID already registered\",\n            }\n          }\n\n          // Check if voter ID is linked to an address\n          const linkedAddress = await state.contract.voterIdToAddress(voterId)\n          if (linkedAddress !== \"0x0000000000000000000000000000000000000000\") {\n            return {\n              isValid: true,\n              isAvailable: false,\n              message: \"Voter ID already linked to another wallet\",\n            }\n          }\n\n          return {\n            isValid: true,\n            isAvailable: true,\n            message: \"Voter ID is valid and available\",\n          }\n        } catch (fallbackError) {\n          console.error(\"Fallback validation failed:\", fallbackError)\n\n          // Method 3: Final fallback - basic validation\n          const validIds = [\n            \"VOTER001\",\n            \"VOTER002\",\n            \"VOTER003\",\n            \"VOTER004\",\n            \"VOTER005\",\n            \"VOTER006\",\n            \"VOTER007\",\n            \"VOTER008\",\n            \"VOTER009\",\n            \"VOTER010\",\n            \"VOTER011\",\n            \"VOTER012\",\n            \"VOTER013\",\n            \"VOTER014\",\n            \"VOTER015\",\n            \"VOTER016\",\n            \"VOTER017\",\n            \"VOTER018\",\n            \"VOTER019\",\n            \"VOTER020\",\n          ]\n\n          const isValid = validIds.includes(voterId)\n          return {\n            isValid: isValid,\n            isAvailable: isValid,\n            message: isValid ? \"Voter ID is valid and available\" : \"Invalid Voter ID format\",\n          }\n        }\n      }\n    } catch (error) {\n      console.error(\"All validation methods failed:\", error)\n      return {\n        isValid: false,\n        isAvailable: false,\n        message: \"Unable to validate voter ID at this time\",\n      }\n    }\n  }\n\n  // Initialize Web3 connection\n  const connectWallet = async () => {\n    try {\n      dispatch({ type: \"SET_LOADING\", payload: true })\n\n      if (!window.ethereum) {\n        throw new Error(\"MetaMask is not installed\")\n      }\n\n      // Check if contract is deployed\n      if (deploymentInfo.contractAddress === \"0x0000000000000000000000000000000000000000\") {\n        throw new Error(\"Contract not deployed. Please run 'npm run hardhat:deploy' first.\")\n      }\n\n      const accounts = await window.ethereum.request({\n        method: \"eth_requestAccounts\",\n      })\n\n      // Check network\n      const chainId = await window.ethereum.request({ method: \"eth_chainId\" })\n      if (chainId !== \"0x539\") {\n        // 1337 in hex\n        try {\n          await window.ethereum.request({\n            method: \"wallet_switchEthereumChain\",\n            params: [{ chainId: \"0x539\" }],\n          })\n        } catch (switchError) {\n          // Network doesn't exist, add it\n          await window.ethereum.request({\n            method: \"wallet_addEthereumChain\",\n            params: [\n              {\n                chainId: \"0x539\",\n                chainName: \"Hardhat Local\",\n                nativeCurrency: {\n                  name: \"ETH\",\n                  symbol: \"ETH\",\n                  decimals: 18,\n                },\n                rpcUrls: [\"http://127.0.0.1:8545\"],\n              },\n            ],\n          })\n        }\n      }\n\n      const provider = new ethers.BrowserProvider(window.ethereum)\n      const signer = await provider.getSigner()\n\n      // Test connection to contract\n      const contract = new ethers.Contract(deploymentInfo.contractAddress, VotingSystemABI.abi, signer)\n\n      // Test contract call\n      try {\n        await contract.electoralCommission()\n      } catch (error) {\n        throw new Error(\"Cannot connect to contract. Make sure Hardhat node is running on localhost:8545\")\n      }\n\n      dispatch({\n        type: \"SET_CONNECTION\",\n        payload: { provider, signer, contract },\n      })\n\n      dispatch({ type: \"SET_ACCOUNT\", payload: accounts[0] })\n\n      // Check if user is admin\n      const electoralCommission = await contract.electoralCommission()\n      const isAdmin = accounts[0].toLowerCase() === electoralCommission.toLowerCase()\n      dispatch({ type: \"SET_IS_ADMIN\", payload: isAdmin })\n\n      // Load voter data if not admin\n      if (!isAdmin) {\n        await loadVoterData(contract, accounts[0])\n      }\n\n      // Load current election and all elections\n      await loadCurrentElection(contract)\n      await loadAllElections(contract)\n\n      toast.success(\"Wallet connected successfully!\")\n    } catch (error) {\n      console.error(\"Connection error:\", error)\n      dispatch({ type: \"SET_ERROR\", payload: error.message })\n      toast.error(error.message)\n    } finally {\n      dispatch({ type: \"SET_LOADING\", payload: false })\n    }\n  }\n\n  // Load voter data\n  const loadVoterData = async (contract, account) => {\n    try {\n      const voter = await contract.getVoter(account)\n      if (voter.walletAddress !== \"0x0000000000000000000000000000000000000000\") {\n        dispatch({ type: \"SET_VOTER\", payload: voter })\n      }\n    } catch (error) {\n      console.error(\"Error loading voter data:\", error)\n    }\n  }\n\n  // Load current election\n  const loadCurrentElection = async (contract) => {\n    try {\n      const election = await contract.getCurrentElection()\n      console.log(\"Current election loaded:\", election)\n\n      if (election.id > 0) {\n        dispatch({ type: \"SET_CURRENT_ELECTION\", payload: election })\n        await loadCandidates(contract, election.id)\n      } else {\n        dispatch({ type: \"SET_CURRENT_ELECTION\", payload: null })\n        dispatch({ type: \"SET_CANDIDATES\", payload: [] })\n      }\n    } catch (error) {\n      console.error(\"Error loading current election:\", error)\n    }\n  }\n\n  // Load all elections\n  const loadAllElections = async (contract) => {\n    try {\n      const electionCounter = await contract.electionCounter()\n      const elections = []\n\n      for (let i = 1; i <= electionCounter; i++) {\n        try {\n          const election = await contract.getElection(i)\n          if (election.id > 0) {\n            elections.push(election)\n          }\n        } catch (error) {\n          console.error(`Error loading election ${i}:`, error)\n        }\n      }\n\n      console.log(\"All elections loaded:\", elections)\n      dispatch({ type: \"SET_ALL_ELECTIONS\", payload: elections })\n    } catch (error) {\n      console.error(\"Error loading all elections:\", error)\n    }\n  }\n\n  // Load candidates for current election\n  const loadCandidates = async (contract, electionId) => {\n    try {\n      const candidates = await contract.getElectionResults(electionId)\n      dispatch({ type: \"SET_CANDIDATES\", payload: candidates })\n    } catch (error) {\n      console.error(\"Error loading candidates:\", error)\n    }\n  }\n\n  // Register voter with improved validation\n  const registerVoter = async (voterData) => {\n    try {\n      dispatch({ type: \"SET_LOADING\", payload: true })\n\n      // Validate voter ID before submitting\n      const validation = await validateVoterId(voterData.voterId)\n\n      if (!validation.isValid || !validation.isAvailable) {\n        toast.error(validation.message)\n        return false\n      }\n\n      // Estimate gas first\n      const gasEstimate = await state.contract.requestRegistration.estimateGas(\n        voterData.voterId,\n        voterData.name,\n        voterData.nationalId,\n        voterData.email,\n      )\n\n      const tx = await state.contract.requestRegistration(\n        voterData.voterId,\n        voterData.name,\n        voterData.nationalId,\n        voterData.email,\n        {\n          gasLimit: (gasEstimate * 120n) / 100n, // Add 20% buffer\n        },\n      )\n\n      await tx.wait()\n      toast.success(\"Registration request submitted successfully!\")\n      return true\n    } catch (error) {\n      console.error(\"Registration error:\", error)\n\n      // Handle specific error messages\n      if (error.message && error.message.includes(\"Voter ID not found in Electoral Commission database\")) {\n        toast.error(\"Voter ID not found in Electoral Commission database\")\n      } else if (error.message && error.message.includes(\"Voter ID already registered\")) {\n        toast.error(\"This Voter ID has already been registered\")\n      } else if (error.message && error.message.includes(\"Voter ID already linked\")) {\n        toast.error(\"This Voter ID is already linked to another wallet\")\n      } else {\n        toast.error(error.reason || \"Registration failed. Please try again.\")\n      }\n      return false\n    } finally {\n      dispatch({ type: \"SET_LOADING\", payload: false })\n    }\n  }\n\n  // Cast vote\n  const castVote = async (candidateId) => {\n    try {\n      dispatch({ type: \"SET_LOADING\", payload: true })\n\n      // Estimate gas first\n      const gasEstimate = await state.contract.vote.estimateGas(candidateId)\n\n      const tx = await state.contract.vote(candidateId, {\n        gasLimit: (gasEstimate * 120n) / 100n, // Add 20% buffer\n      })\n      await tx.wait()\n\n      // Reload voter data and candidates\n      await loadVoterData(state.contract, state.account)\n      await loadCandidates(state.contract, state.currentElection.id)\n\n      toast.success(\"Vote cast successfully!\")\n      return true\n    } catch (error) {\n      console.error(\"Voting error:\", error)\n      toast.error(error.reason || error.message)\n      return false\n    } finally {\n      dispatch({ type: \"SET_LOADING\", payload: false })\n    }\n  }\n\n  // Admin functions\n  const verifyVoter = async (requestId) => {\n    try {\n      dispatch({ type: \"SET_LOADING\", payload: true })\n\n      const gasEstimate = await state.contract.verifyVoter.estimateGas(requestId)\n      const tx = await state.contract.verifyVoter(requestId, {\n        gasLimit: (gasEstimate * 120n) / 100n,\n      })\n      await tx.wait()\n\n      toast.success(\"Voter verified successfully!\")\n      return true\n    } catch (error) {\n      console.error(\"Verification error:\", error)\n      toast.error(error.reason || error.message)\n      return false\n    } finally {\n      dispatch({ type: \"SET_LOADING\", payload: false })\n    }\n  }\n\n  const addCandidate = async (candidateData) => {\n    try {\n      dispatch({ type: \"SET_LOADING\", payload: true })\n\n      const gasEstimate = await state.contract.addCandidate.estimateGas(\n        candidateData.name,\n        candidateData.party,\n        candidateData.imageUrl || \"\",\n      )\n\n      const tx = await state.contract.addCandidate(\n        candidateData.name,\n        candidateData.party,\n        candidateData.imageUrl || \"\",\n        {\n          gasLimit: (gasEstimate * 120n) / 100n,\n        },\n      )\n\n      await tx.wait()\n      toast.success(\"Candidate added successfully!\")\n\n      // Reload all elections to update candidate lists\n      await loadAllElections(state.contract)\n\n      return true\n    } catch (error) {\n      console.error(\"Add candidate error:\", error)\n      toast.error(error.reason || error.message)\n      return false\n    } finally {\n      dispatch({ type: \"SET_LOADING\", payload: false })\n    }\n  }\n\n  const createElection = async (electionData) => {\n    try {\n      dispatch({ type: \"SET_LOADING\", payload: true })\n\n      const gasEstimate = await state.contract.createElection.estimateGas(\n        electionData.title,\n        electionData.description,\n        electionData.candidateIds,\n      )\n\n      const tx = await state.contract.createElection(\n        electionData.title,\n        electionData.description,\n        electionData.candidateIds,\n        {\n          gasLimit: (gasEstimate * 120n) / 100n,\n        },\n      )\n\n      await tx.wait()\n\n      // Reload all elections and current election\n      await loadAllElections(state.contract)\n      await loadCurrentElection(state.contract)\n\n      toast.success(\"Election created successfully!\")\n      return true\n    } catch (error) {\n      console.error(\"Create election error:\", error)\n      toast.error(error.reason || error.message)\n      return false\n    } finally {\n      dispatch({ type: \"SET_LOADING\", payload: false })\n    }\n  }\n\n  const startElection = async (electionId, duration) => {\n    try {\n      dispatch({ type: \"SET_LOADING\", payload: true })\n\n      const gasEstimate = await state.contract.startElection.estimateGas(electionId, duration)\n      const tx = await state.contract.startElection(electionId, duration, {\n        gasLimit: (gasEstimate * 120n) / 100n,\n      })\n      await tx.wait()\n\n      // Reload current election and all elections\n      await loadCurrentElection(state.contract)\n      await loadAllElections(state.contract)\n\n      toast.success(\"Election started successfully!\")\n      return true\n    } catch (error) {\n      console.error(\"Start election error:\", error)\n      toast.error(error.reason || error.message)\n      return false\n    } finally {\n      dispatch({ type: \"SET_LOADING\", payload: false })\n    }\n  }\n\n  const endElection = async (electionId) => {\n    try {\n      dispatch({ type: \"SET_LOADING\", payload: true })\n\n      const gasEstimate = await state.contract.endElection.estimateGas(electionId)\n      const tx = await state.contract.endElection(electionId, {\n        gasLimit: (gasEstimate * 120n) / 100n,\n      })\n      await tx.wait()\n\n      // Reload current election and all elections\n      await loadCurrentElection(state.contract)\n      await loadAllElections(state.contract)\n\n      toast.success(\"Election ended successfully!\")\n      return true\n    } catch (error) {\n      console.error(\"End election error:\", error)\n      toast.error(error.reason || error.message)\n      return false\n    } finally {\n      dispatch({ type: \"SET_LOADING\", payload: false })\n    }\n  }\n\n  // Auto-connect on page load\n  useEffect(() => {\n    const autoConnect = async () => {\n      if (window.ethereum) {\n        try {\n          const accounts = await window.ethereum.request({\n            method: \"eth_accounts\",\n          })\n          if (accounts.length > 0) {\n            await connectWallet()\n          }\n        } catch (error) {\n          console.error(\"Auto-connect error:\", error)\n        }\n      }\n    }\n\n    autoConnect()\n\n    // Listen for account changes\n    if (window.ethereum) {\n      window.ethereum.on(\"accountsChanged\", (accounts) => {\n        if (accounts.length === 0) {\n          dispatch({ type: \"DISCONNECT\" })\n        } else {\n          connectWallet()\n        }\n      })\n\n      window.ethereum.on(\"chainChanged\", () => {\n        window.location.reload()\n      })\n    }\n\n    return () => {\n      if (window.ethereum) {\n        window.ethereum.removeAllListeners(\"accountsChanged\")\n        window.ethereum.removeAllListeners(\"chainChanged\")\n      }\n    }\n  }, [])\n\n  const value = {\n    ...state,\n    connectWallet,\n    registerVoter,\n    castVote,\n    verifyVoter,\n    addCandidate,\n    createElection,\n    startElection,\n    endElection,\n    validateVoterId, // ADDED: Expose validation function\n    loadCurrentElection: () => loadCurrentElection(state.contract),\n    loadAllElections: () => loadAllElections(state.contract),\n    loadCandidates: (electionId) => loadCandidates(state.contract, electionId),\n  }\n\n  return <VotingContext.Provider value={value}>{children}</VotingContext.Provider>\n}\n\nexport function useVoting() {\n  const context = useContext(VotingContext)\n  if (!context) {\n    throw new Error(\"useVoting must be used within a VotingProvider\")\n  }\n  return context\n}\n"],"mappings":"AAAA,YAAY;;AAAA,IAAAA,YAAA;EAAAC,EAAA,GAAAC,YAAA;EAAAC,GAAA,GAAAD,YAAA;AAEZ,SAASE,aAAa,EAAEC,UAAU,EAAEC,UAAU,EAAEC,SAAS,QAAQ,OAAO;AACxE,SAASC,MAAM,QAAQ,QAAQ;AAC/B,OAAOC,KAAK,MAAM,iBAAiB;AACnC,OAAOC,eAAe,MAAM,gCAAgC;;AAE5D;AAAA,SAAAC,MAAA,IAAAC,OAAA;AACA,IAAIC,cAAc;AAClB,IAAI;EACFA,cAAc,GAAGC,OAAO,CAAC,8BAA8B,CAAC;AAC1D,CAAC,CAAC,OAAOC,KAAK,EAAE;EACdC,OAAO,CAACD,KAAK,CAAC,8DAA8D,CAAC;EAC7EF,cAAc,GAAG;IACfI,eAAe,EAAE,4CAA4C;IAC7DC,mBAAmB,EAAE;EACvB,CAAC;AACH;AAEA,MAAMC,aAAa,gBAAGf,aAAa,CAAC,CAAC;AAErC,MAAMgB,YAAY,GAAG;EACnBC,OAAO,EAAE,IAAI;EACbC,QAAQ,EAAE,IAAI;EACdC,QAAQ,EAAE,IAAI;EACdC,MAAM,EAAE,IAAI;EACZC,WAAW,EAAE,KAAK;EAClBC,SAAS,EAAE,KAAK;EAChBC,KAAK,EAAE,IAAI;EACXC,eAAe,EAAE,IAAI;EACrBC,UAAU,EAAE,EAAE;EACdC,YAAY,EAAE,EAAE;EAChBC,OAAO,EAAE,KAAK;EACdhB,KAAK,EAAE;AACT,CAAC;AAED,SAASiB,aAAaA,CAACC,KAAK,EAAEC,MAAM,EAAE;EACpC,QAAQA,MAAM,CAACC,IAAI;IACjB,KAAK,aAAa;MAChB,OAAO;QAAE,GAAGF,KAAK;QAAEP,SAAS,EAAEQ,MAAM,CAACE;MAAQ,CAAC;IAChD,KAAK,aAAa;MAChB,OAAO;QAAE,GAAGH,KAAK;QAAEZ,OAAO,EAAEa,MAAM,CAACE;MAAQ,CAAC;IAC9C,KAAK,gBAAgB;MACnB,OAAO;QACL,GAAGH,KAAK;QACRV,QAAQ,EAAEW,MAAM,CAACE,OAAO,CAACb,QAAQ;QACjCC,MAAM,EAAEU,MAAM,CAACE,OAAO,CAACZ,MAAM;QAC7BF,QAAQ,EAAEY,MAAM,CAACE,OAAO,CAACd,QAAQ;QACjCG,WAAW,EAAE;MACf,CAAC;IACH,KAAK,WAAW;MACd,OAAO;QAAE,GAAGQ,KAAK;QAAEN,KAAK,EAAEO,MAAM,CAACE;MAAQ,CAAC;IAC5C,KAAK,sBAAsB;MACzB,OAAO;QAAE,GAAGH,KAAK;QAAEL,eAAe,EAAEM,MAAM,CAACE;MAAQ,CAAC;IACtD,KAAK,mBAAmB;MACtB,OAAO;QAAE,GAAGH,KAAK;QAAEH,YAAY,EAAEI,MAAM,CAACE;MAAQ,CAAC;IACnD,KAAK,gBAAgB;MACnB,OAAO;QAAE,GAAGH,KAAK;QAAEJ,UAAU,EAAEK,MAAM,CAACE;MAAQ,CAAC;IACjD,KAAK,cAAc;MACjB,OAAO;QAAE,GAAGH,KAAK;QAAEF,OAAO,EAAEG,MAAM,CAACE;MAAQ,CAAC;IAC9C,KAAK,WAAW;MACd,OAAO;QAAE,GAAGH,KAAK;QAAElB,KAAK,EAAEmB,MAAM,CAACE;MAAQ,CAAC;IAC5C,KAAK,YAAY;MACf,OAAO;QAAE,GAAGhB;MAAa,CAAC;IAC5B;MACE,OAAOa,KAAK;EAChB;AACF;AAEA,OAAO,SAASI,cAAcA,CAAC;EAAEC;AAAS,CAAC,EAAE;EAAArC,EAAA;EAC3C,MAAM,CAACgC,KAAK,EAAEM,QAAQ,CAAC,GAAGjC,UAAU,CAAC0B,aAAa,EAAEZ,YAAY,CAAC;;EAEjE;EACA,MAAMoB,eAAe,GAAG,MAAOC,OAAO,IAAK;IACzC,IAAI,CAACA,OAAO,IAAI,CAACR,KAAK,CAACX,QAAQ,EAAE;MAC/B,OAAO;QAAEoB,OAAO,EAAE,KAAK;QAAEC,WAAW,EAAE,KAAK;QAAEC,OAAO,EAAE;MAAgB,CAAC;IACzE;IAEA,IAAI;MACF;MACA,IAAI;QACF,MAAMC,MAAM,GAAG,MAAMZ,KAAK,CAACX,QAAQ,CAACwB,wBAAwB,CAACL,OAAO,CAAC;QACrE,OAAO;UACLC,OAAO,EAAEG,MAAM,CAACH,OAAO;UACvBC,WAAW,EAAEE,MAAM,CAACF,WAAW;UAC/BC,OAAO,EAAEC,MAAM,CAACD;QAClB,CAAC;MACH,CAAC,CAAC,OAAOG,gBAAgB,EAAE;QACzB/B,OAAO,CAACgC,GAAG,CAAC,uDAAuD,CAAC;;QAEpE;QACA,IAAI;UACF;UACA,MAAMC,SAAS,GAAG,MAAMhB,KAAK,CAACX,QAAQ,CAAC4B,aAAa,CAACT,OAAO,CAAC;UAC7D,IAAI,CAACQ,SAAS,EAAE;YACd,OAAO;cACLP,OAAO,EAAE,KAAK;cACdC,WAAW,EAAE,KAAK;cAClBC,OAAO,EAAE;YACX,CAAC;UACH;;UAEA;UACA,MAAMO,MAAM,GAAG,MAAMlB,KAAK,CAACX,QAAQ,CAAC8B,YAAY,CAACX,OAAO,CAAC;UACzD,IAAIU,MAAM,EAAE;YACV,OAAO;cACLT,OAAO,EAAE,IAAI;cACbC,WAAW,EAAE,KAAK;cAClBC,OAAO,EAAE;YACX,CAAC;UACH;;UAEA;UACA,MAAMS,aAAa,GAAG,MAAMpB,KAAK,CAACX,QAAQ,CAACgC,gBAAgB,CAACb,OAAO,CAAC;UACpE,IAAIY,aAAa,KAAK,4CAA4C,EAAE;YAClE,OAAO;cACLX,OAAO,EAAE,IAAI;cACbC,WAAW,EAAE,KAAK;cAClBC,OAAO,EAAE;YACX,CAAC;UACH;UAEA,OAAO;YACLF,OAAO,EAAE,IAAI;YACbC,WAAW,EAAE,IAAI;YACjBC,OAAO,EAAE;UACX,CAAC;QACH,CAAC,CAAC,OAAOW,aAAa,EAAE;UACtBvC,OAAO,CAACD,KAAK,CAAC,6BAA6B,EAAEwC,aAAa,CAAC;;UAE3D;UACA,MAAMC,QAAQ,GAAG,CACf,UAAU,EACV,UAAU,EACV,UAAU,EACV,UAAU,EACV,UAAU,EACV,UAAU,EACV,UAAU,EACV,UAAU,EACV,UAAU,EACV,UAAU,EACV,UAAU,EACV,UAAU,EACV,UAAU,EACV,UAAU,EACV,UAAU,EACV,UAAU,EACV,UAAU,EACV,UAAU,EACV,UAAU,EACV,UAAU,CACX;UAED,MAAMd,OAAO,GAAGc,QAAQ,CAACC,QAAQ,CAAChB,OAAO,CAAC;UAC1C,OAAO;YACLC,OAAO,EAAEA,OAAO;YAChBC,WAAW,EAAED,OAAO;YACpBE,OAAO,EAAEF,OAAO,GAAG,iCAAiC,GAAG;UACzD,CAAC;QACH;MACF;IACF,CAAC,CAAC,OAAO3B,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,gCAAgC,EAAEA,KAAK,CAAC;MACtD,OAAO;QACL2B,OAAO,EAAE,KAAK;QACdC,WAAW,EAAE,KAAK;QAClBC,OAAO,EAAE;MACX,CAAC;IACH;EACF,CAAC;;EAED;EACA,MAAMc,aAAa,GAAG,MAAAA,CAAA,KAAY;IAChC,IAAI;MACFnB,QAAQ,CAAC;QAAEJ,IAAI,EAAE,aAAa;QAAEC,OAAO,EAAE;MAAK,CAAC,CAAC;MAEhD,IAAI,CAACuB,MAAM,CAACC,QAAQ,EAAE;QACpB,MAAM,IAAIC,KAAK,CAAC,2BAA2B,CAAC;MAC9C;;MAEA;MACA,IAAIhD,cAAc,CAACI,eAAe,KAAK,4CAA4C,EAAE;QACnF,MAAM,IAAI4C,KAAK,CAAC,mEAAmE,CAAC;MACtF;MAEA,MAAMC,QAAQ,GAAG,MAAMH,MAAM,CAACC,QAAQ,CAACG,OAAO,CAAC;QAC7CC,MAAM,EAAE;MACV,CAAC,CAAC;;MAEF;MACA,MAAMC,OAAO,GAAG,MAAMN,MAAM,CAACC,QAAQ,CAACG,OAAO,CAAC;QAAEC,MAAM,EAAE;MAAc,CAAC,CAAC;MACxE,IAAIC,OAAO,KAAK,OAAO,EAAE;QACvB;QACA,IAAI;UACF,MAAMN,MAAM,CAACC,QAAQ,CAACG,OAAO,CAAC;YAC5BC,MAAM,EAAE,4BAA4B;YACpCE,MAAM,EAAE,CAAC;cAAED,OAAO,EAAE;YAAQ,CAAC;UAC/B,CAAC,CAAC;QACJ,CAAC,CAAC,OAAOE,WAAW,EAAE;UACpB;UACA,MAAMR,MAAM,CAACC,QAAQ,CAACG,OAAO,CAAC;YAC5BC,MAAM,EAAE,yBAAyB;YACjCE,MAAM,EAAE,CACN;cACED,OAAO,EAAE,OAAO;cAChBG,SAAS,EAAE,eAAe;cAC1BC,cAAc,EAAE;gBACdC,IAAI,EAAE,KAAK;gBACXC,MAAM,EAAE,KAAK;gBACbC,QAAQ,EAAE;cACZ,CAAC;cACDC,OAAO,EAAE,CAAC,uBAAuB;YACnC,CAAC;UAEL,CAAC,CAAC;QACJ;MACF;MAEA,MAAMlD,QAAQ,GAAG,IAAIf,MAAM,CAACkE,eAAe,CAACf,MAAM,CAACC,QAAQ,CAAC;MAC5D,MAAMpC,MAAM,GAAG,MAAMD,QAAQ,CAACoD,SAAS,CAAC,CAAC;;MAEzC;MACA,MAAMrD,QAAQ,GAAG,IAAId,MAAM,CAACoE,QAAQ,CAAC/D,cAAc,CAACI,eAAe,EAAEP,eAAe,CAACmE,GAAG,EAAErD,MAAM,CAAC;;MAEjG;MACA,IAAI;QACF,MAAMF,QAAQ,CAACJ,mBAAmB,CAAC,CAAC;MACtC,CAAC,CAAC,OAAOH,KAAK,EAAE;QACd,MAAM,IAAI8C,KAAK,CAAC,iFAAiF,CAAC;MACpG;MAEAtB,QAAQ,CAAC;QACPJ,IAAI,EAAE,gBAAgB;QACtBC,OAAO,EAAE;UAAEb,QAAQ;UAAEC,MAAM;UAAEF;QAAS;MACxC,CAAC,CAAC;MAEFiB,QAAQ,CAAC;QAAEJ,IAAI,EAAE,aAAa;QAAEC,OAAO,EAAE0B,QAAQ,CAAC,CAAC;MAAE,CAAC,CAAC;;MAEvD;MACA,MAAM5C,mBAAmB,GAAG,MAAMI,QAAQ,CAACJ,mBAAmB,CAAC,CAAC;MAChE,MAAMa,OAAO,GAAG+B,QAAQ,CAAC,CAAC,CAAC,CAACgB,WAAW,CAAC,CAAC,KAAK5D,mBAAmB,CAAC4D,WAAW,CAAC,CAAC;MAC/EvC,QAAQ,CAAC;QAAEJ,IAAI,EAAE,cAAc;QAAEC,OAAO,EAAEL;MAAQ,CAAC,CAAC;;MAEpD;MACA,IAAI,CAACA,OAAO,EAAE;QACZ,MAAMgD,aAAa,CAACzD,QAAQ,EAAEwC,QAAQ,CAAC,CAAC,CAAC,CAAC;MAC5C;;MAEA;MACA,MAAMkB,mBAAmB,CAAC1D,QAAQ,CAAC;MACnC,MAAM2D,gBAAgB,CAAC3D,QAAQ,CAAC;MAEhCb,KAAK,CAACyE,OAAO,CAAC,gCAAgC,CAAC;IACjD,CAAC,CAAC,OAAOnE,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,mBAAmB,EAAEA,KAAK,CAAC;MACzCwB,QAAQ,CAAC;QAAEJ,IAAI,EAAE,WAAW;QAAEC,OAAO,EAAErB,KAAK,CAAC6B;MAAQ,CAAC,CAAC;MACvDnC,KAAK,CAACM,KAAK,CAACA,KAAK,CAAC6B,OAAO,CAAC;IAC5B,CAAC,SAAS;MACRL,QAAQ,CAAC;QAAEJ,IAAI,EAAE,aAAa;QAAEC,OAAO,EAAE;MAAM,CAAC,CAAC;IACnD;EACF,CAAC;;EAED;EACA,MAAM2C,aAAa,GAAG,MAAAA,CAAOzD,QAAQ,EAAED,OAAO,KAAK;IACjD,IAAI;MACF,MAAMM,KAAK,GAAG,MAAML,QAAQ,CAAC6D,QAAQ,CAAC9D,OAAO,CAAC;MAC9C,IAAIM,KAAK,CAACyD,aAAa,KAAK,4CAA4C,EAAE;QACxE7C,QAAQ,CAAC;UAAEJ,IAAI,EAAE,WAAW;UAAEC,OAAO,EAAET;QAAM,CAAC,CAAC;MACjD;IACF,CAAC,CAAC,OAAOZ,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;IACnD;EACF,CAAC;;EAED;EACA,MAAMiE,mBAAmB,GAAG,MAAO1D,QAAQ,IAAK;IAC9C,IAAI;MACF,MAAM+D,QAAQ,GAAG,MAAM/D,QAAQ,CAACgE,kBAAkB,CAAC,CAAC;MACpDtE,OAAO,CAACgC,GAAG,CAAC,0BAA0B,EAAEqC,QAAQ,CAAC;MAEjD,IAAIA,QAAQ,CAACE,EAAE,GAAG,CAAC,EAAE;QACnBhD,QAAQ,CAAC;UAAEJ,IAAI,EAAE,sBAAsB;UAAEC,OAAO,EAAEiD;QAAS,CAAC,CAAC;QAC7D,MAAMG,cAAc,CAAClE,QAAQ,EAAE+D,QAAQ,CAACE,EAAE,CAAC;MAC7C,CAAC,MAAM;QACLhD,QAAQ,CAAC;UAAEJ,IAAI,EAAE,sBAAsB;UAAEC,OAAO,EAAE;QAAK,CAAC,CAAC;QACzDG,QAAQ,CAAC;UAAEJ,IAAI,EAAE,gBAAgB;UAAEC,OAAO,EAAE;QAAG,CAAC,CAAC;MACnD;IACF,CAAC,CAAC,OAAOrB,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,iCAAiC,EAAEA,KAAK,CAAC;IACzD;EACF,CAAC;;EAED;EACA,MAAMkE,gBAAgB,GAAG,MAAO3D,QAAQ,IAAK;IAC3C,IAAI;MACF,MAAMmE,eAAe,GAAG,MAAMnE,QAAQ,CAACmE,eAAe,CAAC,CAAC;MACxD,MAAMC,SAAS,GAAG,EAAE;MAEpB,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,IAAIF,eAAe,EAAEE,CAAC,EAAE,EAAE;QACzC,IAAI;UACF,MAAMN,QAAQ,GAAG,MAAM/D,QAAQ,CAACsE,WAAW,CAACD,CAAC,CAAC;UAC9C,IAAIN,QAAQ,CAACE,EAAE,GAAG,CAAC,EAAE;YACnBG,SAAS,CAACG,IAAI,CAACR,QAAQ,CAAC;UAC1B;QACF,CAAC,CAAC,OAAOtE,KAAK,EAAE;UACdC,OAAO,CAACD,KAAK,CAAC,0BAA0B4E,CAAC,GAAG,EAAE5E,KAAK,CAAC;QACtD;MACF;MAEAC,OAAO,CAACgC,GAAG,CAAC,uBAAuB,EAAE0C,SAAS,CAAC;MAC/CnD,QAAQ,CAAC;QAAEJ,IAAI,EAAE,mBAAmB;QAAEC,OAAO,EAAEsD;MAAU,CAAC,CAAC;IAC7D,CAAC,CAAC,OAAO3E,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;IACtD;EACF,CAAC;;EAED;EACA,MAAMyE,cAAc,GAAG,MAAAA,CAAOlE,QAAQ,EAAEwE,UAAU,KAAK;IACrD,IAAI;MACF,MAAMjE,UAAU,GAAG,MAAMP,QAAQ,CAACyE,kBAAkB,CAACD,UAAU,CAAC;MAChEvD,QAAQ,CAAC;QAAEJ,IAAI,EAAE,gBAAgB;QAAEC,OAAO,EAAEP;MAAW,CAAC,CAAC;IAC3D,CAAC,CAAC,OAAOd,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,2BAA2B,EAAEA,KAAK,CAAC;IACnD;EACF,CAAC;;EAED;EACA,MAAMiF,aAAa,GAAG,MAAOC,SAAS,IAAK;IACzC,IAAI;MACF1D,QAAQ,CAAC;QAAEJ,IAAI,EAAE,aAAa;QAAEC,OAAO,EAAE;MAAK,CAAC,CAAC;;MAEhD;MACA,MAAM8D,UAAU,GAAG,MAAM1D,eAAe,CAACyD,SAAS,CAACxD,OAAO,CAAC;MAE3D,IAAI,CAACyD,UAAU,CAACxD,OAAO,IAAI,CAACwD,UAAU,CAACvD,WAAW,EAAE;QAClDlC,KAAK,CAACM,KAAK,CAACmF,UAAU,CAACtD,OAAO,CAAC;QAC/B,OAAO,KAAK;MACd;;MAEA;MACA,MAAMuD,WAAW,GAAG,MAAMlE,KAAK,CAACX,QAAQ,CAAC8E,mBAAmB,CAACC,WAAW,CACtEJ,SAAS,CAACxD,OAAO,EACjBwD,SAAS,CAAC3B,IAAI,EACd2B,SAAS,CAACK,UAAU,EACpBL,SAAS,CAACM,KACZ,CAAC;MAED,MAAMC,EAAE,GAAG,MAAMvE,KAAK,CAACX,QAAQ,CAAC8E,mBAAmB,CACjDH,SAAS,CAACxD,OAAO,EACjBwD,SAAS,CAAC3B,IAAI,EACd2B,SAAS,CAACK,UAAU,EACpBL,SAAS,CAACM,KAAK,EACf;QACEE,QAAQ,EAAGN,WAAW,GAAG,IAAI,GAAI,IAAI,CAAE;MACzC,CACF,CAAC;MAED,MAAMK,EAAE,CAACE,IAAI,CAAC,CAAC;MACfjG,KAAK,CAACyE,OAAO,CAAC,8CAA8C,CAAC;MAC7D,OAAO,IAAI;IACb,CAAC,CAAC,OAAOnE,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,qBAAqB,EAAEA,KAAK,CAAC;;MAE3C;MACA,IAAIA,KAAK,CAAC6B,OAAO,IAAI7B,KAAK,CAAC6B,OAAO,CAACa,QAAQ,CAAC,qDAAqD,CAAC,EAAE;QAClGhD,KAAK,CAACM,KAAK,CAAC,qDAAqD,CAAC;MACpE,CAAC,MAAM,IAAIA,KAAK,CAAC6B,OAAO,IAAI7B,KAAK,CAAC6B,OAAO,CAACa,QAAQ,CAAC,6BAA6B,CAAC,EAAE;QACjFhD,KAAK,CAACM,KAAK,CAAC,2CAA2C,CAAC;MAC1D,CAAC,MAAM,IAAIA,KAAK,CAAC6B,OAAO,IAAI7B,KAAK,CAAC6B,OAAO,CAACa,QAAQ,CAAC,yBAAyB,CAAC,EAAE;QAC7EhD,KAAK,CAACM,KAAK,CAAC,mDAAmD,CAAC;MAClE,CAAC,MAAM;QACLN,KAAK,CAACM,KAAK,CAACA,KAAK,CAAC4F,MAAM,IAAI,wCAAwC,CAAC;MACvE;MACA,OAAO,KAAK;IACd,CAAC,SAAS;MACRpE,QAAQ,CAAC;QAAEJ,IAAI,EAAE,aAAa;QAAEC,OAAO,EAAE;MAAM,CAAC,CAAC;IACnD;EACF,CAAC;;EAED;EACA,MAAMwE,QAAQ,GAAG,MAAOC,WAAW,IAAK;IACtC,IAAI;MACFtE,QAAQ,CAAC;QAAEJ,IAAI,EAAE,aAAa;QAAEC,OAAO,EAAE;MAAK,CAAC,CAAC;;MAEhD;MACA,MAAM+D,WAAW,GAAG,MAAMlE,KAAK,CAACX,QAAQ,CAACwF,IAAI,CAACT,WAAW,CAACQ,WAAW,CAAC;MAEtE,MAAML,EAAE,GAAG,MAAMvE,KAAK,CAACX,QAAQ,CAACwF,IAAI,CAACD,WAAW,EAAE;QAChDJ,QAAQ,EAAGN,WAAW,GAAG,IAAI,GAAI,IAAI,CAAE;MACzC,CAAC,CAAC;MACF,MAAMK,EAAE,CAACE,IAAI,CAAC,CAAC;;MAEf;MACA,MAAM3B,aAAa,CAAC9C,KAAK,CAACX,QAAQ,EAAEW,KAAK,CAACZ,OAAO,CAAC;MAClD,MAAMmE,cAAc,CAACvD,KAAK,CAACX,QAAQ,EAAEW,KAAK,CAACL,eAAe,CAAC2D,EAAE,CAAC;MAE9D9E,KAAK,CAACyE,OAAO,CAAC,yBAAyB,CAAC;MACxC,OAAO,IAAI;IACb,CAAC,CAAC,OAAOnE,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,eAAe,EAAEA,KAAK,CAAC;MACrCN,KAAK,CAACM,KAAK,CAACA,KAAK,CAAC4F,MAAM,IAAI5F,KAAK,CAAC6B,OAAO,CAAC;MAC1C,OAAO,KAAK;IACd,CAAC,SAAS;MACRL,QAAQ,CAAC;QAAEJ,IAAI,EAAE,aAAa;QAAEC,OAAO,EAAE;MAAM,CAAC,CAAC;IACnD;EACF,CAAC;;EAED;EACA,MAAM2E,WAAW,GAAG,MAAOC,SAAS,IAAK;IACvC,IAAI;MACFzE,QAAQ,CAAC;QAAEJ,IAAI,EAAE,aAAa;QAAEC,OAAO,EAAE;MAAK,CAAC,CAAC;MAEhD,MAAM+D,WAAW,GAAG,MAAMlE,KAAK,CAACX,QAAQ,CAACyF,WAAW,CAACV,WAAW,CAACW,SAAS,CAAC;MAC3E,MAAMR,EAAE,GAAG,MAAMvE,KAAK,CAACX,QAAQ,CAACyF,WAAW,CAACC,SAAS,EAAE;QACrDP,QAAQ,EAAGN,WAAW,GAAG,IAAI,GAAI;MACnC,CAAC,CAAC;MACF,MAAMK,EAAE,CAACE,IAAI,CAAC,CAAC;MAEfjG,KAAK,CAACyE,OAAO,CAAC,8BAA8B,CAAC;MAC7C,OAAO,IAAI;IACb,CAAC,CAAC,OAAOnE,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,qBAAqB,EAAEA,KAAK,CAAC;MAC3CN,KAAK,CAACM,KAAK,CAACA,KAAK,CAAC4F,MAAM,IAAI5F,KAAK,CAAC6B,OAAO,CAAC;MAC1C,OAAO,KAAK;IACd,CAAC,SAAS;MACRL,QAAQ,CAAC;QAAEJ,IAAI,EAAE,aAAa;QAAEC,OAAO,EAAE;MAAM,CAAC,CAAC;IACnD;EACF,CAAC;EAED,MAAM6E,YAAY,GAAG,MAAOC,aAAa,IAAK;IAC5C,IAAI;MACF3E,QAAQ,CAAC;QAAEJ,IAAI,EAAE,aAAa;QAAEC,OAAO,EAAE;MAAK,CAAC,CAAC;MAEhD,MAAM+D,WAAW,GAAG,MAAMlE,KAAK,CAACX,QAAQ,CAAC2F,YAAY,CAACZ,WAAW,CAC/Da,aAAa,CAAC5C,IAAI,EAClB4C,aAAa,CAACC,KAAK,EACnBD,aAAa,CAACE,QAAQ,IAAI,EAC5B,CAAC;MAED,MAAMZ,EAAE,GAAG,MAAMvE,KAAK,CAACX,QAAQ,CAAC2F,YAAY,CAC1CC,aAAa,CAAC5C,IAAI,EAClB4C,aAAa,CAACC,KAAK,EACnBD,aAAa,CAACE,QAAQ,IAAI,EAAE,EAC5B;QACEX,QAAQ,EAAGN,WAAW,GAAG,IAAI,GAAI;MACnC,CACF,CAAC;MAED,MAAMK,EAAE,CAACE,IAAI,CAAC,CAAC;MACfjG,KAAK,CAACyE,OAAO,CAAC,+BAA+B,CAAC;;MAE9C;MACA,MAAMD,gBAAgB,CAAChD,KAAK,CAACX,QAAQ,CAAC;MAEtC,OAAO,IAAI;IACb,CAAC,CAAC,OAAOP,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,sBAAsB,EAAEA,KAAK,CAAC;MAC5CN,KAAK,CAACM,KAAK,CAACA,KAAK,CAAC4F,MAAM,IAAI5F,KAAK,CAAC6B,OAAO,CAAC;MAC1C,OAAO,KAAK;IACd,CAAC,SAAS;MACRL,QAAQ,CAAC;QAAEJ,IAAI,EAAE,aAAa;QAAEC,OAAO,EAAE;MAAM,CAAC,CAAC;IACnD;EACF,CAAC;EAED,MAAMiF,cAAc,GAAG,MAAOC,YAAY,IAAK;IAC7C,IAAI;MACF/E,QAAQ,CAAC;QAAEJ,IAAI,EAAE,aAAa;QAAEC,OAAO,EAAE;MAAK,CAAC,CAAC;MAEhD,MAAM+D,WAAW,GAAG,MAAMlE,KAAK,CAACX,QAAQ,CAAC+F,cAAc,CAAChB,WAAW,CACjEiB,YAAY,CAACC,KAAK,EAClBD,YAAY,CAACE,WAAW,EACxBF,YAAY,CAACG,YACf,CAAC;MAED,MAAMjB,EAAE,GAAG,MAAMvE,KAAK,CAACX,QAAQ,CAAC+F,cAAc,CAC5CC,YAAY,CAACC,KAAK,EAClBD,YAAY,CAACE,WAAW,EACxBF,YAAY,CAACG,YAAY,EACzB;QACEhB,QAAQ,EAAGN,WAAW,GAAG,IAAI,GAAI;MACnC,CACF,CAAC;MAED,MAAMK,EAAE,CAACE,IAAI,CAAC,CAAC;;MAEf;MACA,MAAMzB,gBAAgB,CAAChD,KAAK,CAACX,QAAQ,CAAC;MACtC,MAAM0D,mBAAmB,CAAC/C,KAAK,CAACX,QAAQ,CAAC;MAEzCb,KAAK,CAACyE,OAAO,CAAC,gCAAgC,CAAC;MAC/C,OAAO,IAAI;IACb,CAAC,CAAC,OAAOnE,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,wBAAwB,EAAEA,KAAK,CAAC;MAC9CN,KAAK,CAACM,KAAK,CAACA,KAAK,CAAC4F,MAAM,IAAI5F,KAAK,CAAC6B,OAAO,CAAC;MAC1C,OAAO,KAAK;IACd,CAAC,SAAS;MACRL,QAAQ,CAAC;QAAEJ,IAAI,EAAE,aAAa;QAAEC,OAAO,EAAE;MAAM,CAAC,CAAC;IACnD;EACF,CAAC;EAED,MAAMsF,aAAa,GAAG,MAAAA,CAAO5B,UAAU,EAAE6B,QAAQ,KAAK;IACpD,IAAI;MACFpF,QAAQ,CAAC;QAAEJ,IAAI,EAAE,aAAa;QAAEC,OAAO,EAAE;MAAK,CAAC,CAAC;MAEhD,MAAM+D,WAAW,GAAG,MAAMlE,KAAK,CAACX,QAAQ,CAACoG,aAAa,CAACrB,WAAW,CAACP,UAAU,EAAE6B,QAAQ,CAAC;MACxF,MAAMnB,EAAE,GAAG,MAAMvE,KAAK,CAACX,QAAQ,CAACoG,aAAa,CAAC5B,UAAU,EAAE6B,QAAQ,EAAE;QAClElB,QAAQ,EAAGN,WAAW,GAAG,IAAI,GAAI;MACnC,CAAC,CAAC;MACF,MAAMK,EAAE,CAACE,IAAI,CAAC,CAAC;;MAEf;MACA,MAAM1B,mBAAmB,CAAC/C,KAAK,CAACX,QAAQ,CAAC;MACzC,MAAM2D,gBAAgB,CAAChD,KAAK,CAACX,QAAQ,CAAC;MAEtCb,KAAK,CAACyE,OAAO,CAAC,gCAAgC,CAAC;MAC/C,OAAO,IAAI;IACb,CAAC,CAAC,OAAOnE,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;MAC7CN,KAAK,CAACM,KAAK,CAACA,KAAK,CAAC4F,MAAM,IAAI5F,KAAK,CAAC6B,OAAO,CAAC;MAC1C,OAAO,KAAK;IACd,CAAC,SAAS;MACRL,QAAQ,CAAC;QAAEJ,IAAI,EAAE,aAAa;QAAEC,OAAO,EAAE;MAAM,CAAC,CAAC;IACnD;EACF,CAAC;EAED,MAAMwF,WAAW,GAAG,MAAO9B,UAAU,IAAK;IACxC,IAAI;MACFvD,QAAQ,CAAC;QAAEJ,IAAI,EAAE,aAAa;QAAEC,OAAO,EAAE;MAAK,CAAC,CAAC;MAEhD,MAAM+D,WAAW,GAAG,MAAMlE,KAAK,CAACX,QAAQ,CAACsG,WAAW,CAACvB,WAAW,CAACP,UAAU,CAAC;MAC5E,MAAMU,EAAE,GAAG,MAAMvE,KAAK,CAACX,QAAQ,CAACsG,WAAW,CAAC9B,UAAU,EAAE;QACtDW,QAAQ,EAAGN,WAAW,GAAG,IAAI,GAAI;MACnC,CAAC,CAAC;MACF,MAAMK,EAAE,CAACE,IAAI,CAAC,CAAC;;MAEf;MACA,MAAM1B,mBAAmB,CAAC/C,KAAK,CAACX,QAAQ,CAAC;MACzC,MAAM2D,gBAAgB,CAAChD,KAAK,CAACX,QAAQ,CAAC;MAEtCb,KAAK,CAACyE,OAAO,CAAC,8BAA8B,CAAC;MAC7C,OAAO,IAAI;IACb,CAAC,CAAC,OAAOnE,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAAC,qBAAqB,EAAEA,KAAK,CAAC;MAC3CN,KAAK,CAACM,KAAK,CAACA,KAAK,CAAC4F,MAAM,IAAI5F,KAAK,CAAC6B,OAAO,CAAC;MAC1C,OAAO,KAAK;IACd,CAAC,SAAS;MACRL,QAAQ,CAAC;QAAEJ,IAAI,EAAE,aAAa;QAAEC,OAAO,EAAE;MAAM,CAAC,CAAC;IACnD;EACF,CAAC;;EAED;EACA7B,SAAS,CAAC,MAAM;IACd,MAAMsH,WAAW,GAAG,MAAAA,CAAA,KAAY;MAC9B,IAAIlE,MAAM,CAACC,QAAQ,EAAE;QACnB,IAAI;UACF,MAAME,QAAQ,GAAG,MAAMH,MAAM,CAACC,QAAQ,CAACG,OAAO,CAAC;YAC7CC,MAAM,EAAE;UACV,CAAC,CAAC;UACF,IAAIF,QAAQ,CAACgE,MAAM,GAAG,CAAC,EAAE;YACvB,MAAMpE,aAAa,CAAC,CAAC;UACvB;QACF,CAAC,CAAC,OAAO3C,KAAK,EAAE;UACdC,OAAO,CAACD,KAAK,CAAC,qBAAqB,EAAEA,KAAK,CAAC;QAC7C;MACF;IACF,CAAC;IAED8G,WAAW,CAAC,CAAC;;IAEb;IACA,IAAIlE,MAAM,CAACC,QAAQ,EAAE;MACnBD,MAAM,CAACC,QAAQ,CAACmE,EAAE,CAAC,iBAAiB,EAAGjE,QAAQ,IAAK;QAClD,IAAIA,QAAQ,CAACgE,MAAM,KAAK,CAAC,EAAE;UACzBvF,QAAQ,CAAC;YAAEJ,IAAI,EAAE;UAAa,CAAC,CAAC;QAClC,CAAC,MAAM;UACLuB,aAAa,CAAC,CAAC;QACjB;MACF,CAAC,CAAC;MAEFC,MAAM,CAACC,QAAQ,CAACmE,EAAE,CAAC,cAAc,EAAE,MAAM;QACvCpE,MAAM,CAACqE,QAAQ,CAACC,MAAM,CAAC,CAAC;MAC1B,CAAC,CAAC;IACJ;IAEA,OAAO,MAAM;MACX,IAAItE,MAAM,CAACC,QAAQ,EAAE;QACnBD,MAAM,CAACC,QAAQ,CAACsE,kBAAkB,CAAC,iBAAiB,CAAC;QACrDvE,MAAM,CAACC,QAAQ,CAACsE,kBAAkB,CAAC,cAAc,CAAC;MACpD;IACF,CAAC;EACH,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMC,KAAK,GAAG;IACZ,GAAGlG,KAAK;IACRyB,aAAa;IACbsC,aAAa;IACbY,QAAQ;IACRG,WAAW;IACXE,YAAY;IACZI,cAAc;IACdK,aAAa;IACbE,WAAW;IACXpF,eAAe;IAAE;IACjBwC,mBAAmB,EAAEA,CAAA,KAAMA,mBAAmB,CAAC/C,KAAK,CAACX,QAAQ,CAAC;IAC9D2D,gBAAgB,EAAEA,CAAA,KAAMA,gBAAgB,CAAChD,KAAK,CAACX,QAAQ,CAAC;IACxDkE,cAAc,EAAGM,UAAU,IAAKN,cAAc,CAACvD,KAAK,CAACX,QAAQ,EAAEwE,UAAU;EAC3E,CAAC;EAED,oBAAOlF,OAAA,CAACO,aAAa,CAACiH,QAAQ;IAACD,KAAK,EAAEA,KAAM;IAAA7F,QAAA,EAAEA;EAAQ;IAAA+F,QAAA,EAAArI,YAAA;IAAAsI,UAAA;IAAAC,YAAA;EAAA,OAAyB,CAAC;AAClF;AAACtI,EAAA,CA7hBeoC,cAAc;AAAAmG,EAAA,GAAdnG,cAAc;AA+hB9B,OAAO,SAASoG,SAASA,CAAA,EAAG;EAAAtI,GAAA;EAC1B,MAAMuI,OAAO,GAAGrI,UAAU,CAACc,aAAa,CAAC;EACzC,IAAI,CAACuH,OAAO,EAAE;IACZ,MAAM,IAAI7E,KAAK,CAAC,gDAAgD,CAAC;EACnE;EACA,OAAO6E,OAAO;AAChB;AAACvI,GAAA,CANesI,SAAS;AAAA,IAAAD,EAAA;AAAAG,YAAA,CAAAH,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}